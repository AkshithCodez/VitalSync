{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="welcome-header">
    <h3>Managing: <strong>{{ user.condition }}</strong></h3>
</div>

<div class="report-container card-container">
    <h2>ü§ñ AI Health Report</h2>
    <div class="report-container card-container">
    <div class="header-with-button">
        <h2>ü§ñ AI Health Report</h2>
        {% if user.ai_report %}
            <a href="{{ url_for('main.download_report') }}" class="reset-button" target="_blank">Download PDF</a>
        {% endif %}
    </div>
    {% if user.ai_report %}
        <div class="report-content">
            <pre>{{ user.ai_report }}</pre>
        </div>
    {% else %}
        <div class="generating-message">
            <p>Your personalized AI report is being generated. Please check back in a minute and refresh the page.</p>
        </div>
        <div class="disclaimer">
            <p><strong>Important Disclaimer:</strong> The information provided is for informational purposes only and is not a substitute for professional medical advice. Always seek the advice of your physician.</p>
        </div>
    {% endif %}
</div>

<div class="tracker-container card-container">
    <div class="header-with-button">
        <h2>‚úÖ Daily Health Tracker</h2>
        <a href="{{ url_for('main.reset_tasks') }}" class="reset-button">Reset Day</a>
    </div>
    <form action="{{ url_for('main.add_task') }}" method="POST" class="input-form">
        <input type="text" name="task" placeholder="Add a new daily task..." required>
        <button type="submit" {% if tasks|length >= 15 %}disabled{% endif %}>Add Task</button>
    </form>
    <ul class="task-list">
        {% for task in tasks %}
        <li class="{% if task.done %}done{% endif %}">
            <a href="{{ url_for('main.toggle_task', task_id=task.id) }}" class="task-content">
                <span class="checkbox"></span>
                {{ task.text }}
            </a>
            <a href="{{ url_for('main.delete_task', task_id=task.id) }}" class="delete-button">√ó</a>
        </li>
        {% else %}
        <p class="empty-state">No daily tasks added yet.</p>
        {% endfor %}
    </ul>
</div>

<div class="planner-container card-container">
    <h2>üóìÔ∏è Doctor's Visit Planner</h2>
    <p>Jot down questions for your next appointment.</p>
    <form action="{{ url_for('main.add_item') }}" method="POST" class="input-form">
        <input type="text" name="item" placeholder="e.g., Ask about side effects..." required>
        <button type="submit">Add</button>
    </form>
    <ul class="task-list">
        {% for item in items %}
        <li>
            <span class="task-content">{{ item.text }}</span>
            <a href="{{ url_for('main.delete_item', item_id=item.id) }}" class="delete-button">√ó</a>
        </li>
        {% else %}
        <p class="empty-state">No questions added yet.</p>
        {% endfor %}
    </ul>
</div>
{% endblock %}