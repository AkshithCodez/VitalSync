{% extends "base.html" %}

{% block title %}Diet Planner{% endblock %}

{% block content %}
<div class="welcome-header">
    <h3>Diet Planner for {{ today.strftime('%A, %B %d') }}</h3>
</div>

<div class="dashboard-layout">
    <div class="dashboard-column">
        <div class="card-container">
            <h2>AI Meal Plan Generator</h2>
            <form action="{{ url_for('main.generate_meal_plan') }}" method="POST" class="input-form-stacked">
                <label for="calories">Target Calories:</label>
                <input type="number" name="calories" value="2000" class="small-input">
                <label for="diet_pref">Dietary Preference:</label>
                <select name="diet_pref">
                    <option value="a balanced">Balanced</option>
                    <option value="vegetarian">Vegetarian</option>
                    <option value="low-carb">Low-Carb</option>
                    <option value="low-fat">Low-Fat</option>
                </select>
                <button type="submit">Generate Today's Plan</button>
            </form>
        </div>
        <div class="card-container">
            <h2>Today's Totals</h2>
            <div class="totals-grid">
                <div><span>Calories</span>{{ totals.calories }} kcal</div>
                <div><span>Protein</span>{{ totals.protein }} g</div>
                <div><span>Carbs</span>{{ totals.carbs }} g</div>
                <div><span>Fats</span>{{ totals.fats }} g</div>
            </div>
            <a href="{{ url_for('main.grocery_list') }}" class="button-full-width">Generate Grocery List</a>
        </div>
    </div>

    <div class="dashboard-column">
        {% for meal_type in ['Breakfast', 'Lunch', 'Dinner', 'Snacks'] %}
        <div class="card-container">
            <h2>{{ meal_type }}</h2>
            <ul class="meal-list">
                {% for meal in meals if meal.meal_type == meal_type %}
                <li>
                    <span>{{ meal.food_item }} ({{ meal.calories }} kcal)</span>
                    <a href="{{ url_for('main.delete_meal', meal_id=meal.id) }}" class="delete-button-small">Ã—</a>
                </li>
                {% endfor %}
            </ul>
            <form action="{{ url_for('main.add_meal') }}" method="POST" class="input-form">
                <input type="hidden" name="meal_type" value="{{ meal_type }}">
                <input type="text" name="food_item" placeholder="e.g., 1 large apple" required>
                <button type="submit">Add Food</button>
            </form>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}